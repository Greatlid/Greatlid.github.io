<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>账户注册</title>

	<style type="text/css">
	body,input{
		margin: 0;
		padding: 0;
		background: #ecffc0;
	}
	input{
		display: inline-block;
		background: #fff;
	}
	.xiao-container{
		width: 100%;
	}
	.xiao-register-box{
		position: relative;
		height: 800px;
		width: 800px;
		top: 50px;
		margin: 0 auto;
		z-index: 99999;
		background:#ffffff;
		border: 7px solid #ccc;
	}
	.xiao-title-box{
		position: absolute;
		width: 300px;
		height: 50px;
		margin-left: 250px;
		margin-top: 5px;
		text-align: center;
		font-size: 28px;
		font-weight: 800;
		color: #ff5000;
		line-height: 50px;
	}
	.xiao-username-box{
		position: absolute;
		width: 600px;
		height: 40px;
		line-height: 40px;
		margin-top:100px;
		margin-left:80px;
		font-weight: 700;
	}
	.xiao-username-input{
		display: inline-block;
		margin-left: 45px;
		/*background: green;*/
	}
	#username{
		height: 35px;
		width: 290px;
		border: 2px solid #ccc;
		border-radius: 5px;
	}
	.xiao-userPassword-box{
		position: absolute;
		width: 600px;
		height: 40px;
		line-height: 40px;
		margin-top:180px;
		margin-left:80px;
		font-weight: 700;
	}
	.xiao-userPassword-input{
		display: inline-block;
		margin-left: 61px;
	}
	#userPassword{
		height: 35px;
		width: 290px;
		border: 2px solid #ccc;
		border-radius: 5px;
	}
	.xiao-userRePassword-box{
		position: absolute;
		width: 600px;
		height: 40px;
		line-height: 40px;
		margin-top:260px;
		margin-left:80px;
		font-weight: 700;
	}
	.xiao-userRePassword-input{
		display: inline-block;
		margin-left: 28px;
	}
	#userRePassword{
		height: 35px;
		width: 290px;
		border: 2px solid #ccc;
		border-radius: 5px;
	}
	.xiao-userPhone-box{
		position: absolute;
		width: 600px;
		height: 40px;
		line-height: 40px;
		margin-top:340px;
		margin-left:80px;
		font-weight: 700;
	}
	.xiao-userPhone-input{
		display: inline-block;
		margin-left: 28px;
	}
	#userPhone{
		height: 35px;
		width: 290px;
		border: 2px solid #ccc;
		border-radius: 5px;
	}
	.xiao-userEmail-box{
		position: absolute;
		width: 600px;
		height: 40px;
		line-height: 40px;
		margin-top:420px;
		margin-left:80px;
		font-weight: 700;
	}
	.xiao-userEmail-input{
		display: inline-block;
		margin-left: 28px;
	}
	#userEmail{
		height: 35px;
		width: 290px;
		border: 2px solid #ccc;
		border-radius: 5px;
	}
    .xiao-userMajor-box{
		position: absolute;
		width: 600px;
		height: 40px;
		line-height: 40px;
		margin-top:500px;
		margin-left:80px;
		font-weight: 700;
	}
	.xiao-userMajor-input{
		display: inline-block;
		margin-left: 61px;
	}
	#userMajor{
		height: 35px;
		width: 290px;
		border: 2px solid #ccc;
		border-radius: 5px;
	}
    .xiao-userGrade-box{
		position: absolute;
		width: 600px;
		height: 40px;
		line-height: 40px;
		margin-top:580px;
		margin-left:80px;
		font-weight: 700;
	}
	.xiao-userGrade-input{
		display: inline-block;
		margin-left: 61px;
	}
	#userGrade{
		height: 35px;
		width: 290px;
		border: 2px solid #ccc;
		border-radius: 5px;
	}
	.xiao-userGender-box{
		position: absolute;
		width: 600px;
		height: 40px;
		line-height: 40px;
		margin-top:660px;
		margin-left:82px;
		font-weight: 700;
	}
	.xiao-userGender-input{
		display: inline-block;
		margin-left: 62px;
	}
	.xiao-require{
		color: red;
	}
	.xiao-submit-box{
		position:absolute;
		width: 80px;
		height: 40px;
		line-height: 40px;
		margin-top: 710px;
		margin-left:200px;
		border-radius: 5px;
		background: grey;
	}
	#xiao-submit-button{
		display: inline-block;
		width: 80px;
		height: 40px;
		border-radius: 5px;
		background: red;
	}
	.xiao-goLogin-box{
		position:absolute;
		width: 150px;
		height: 20px;
		margin-top: 720px;
		margin-left:320px;

	}

	</style>
</head>

 <script type="text/javascript">
	//onblur失去焦点事件，用户离开输入框时执行 JavaScript 代码：

          //函数1：验证邮箱格式
      function validate_username(username){
        //定义正则表达式的变量:邮箱正则
        var emailReg=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;
        //console.log(username);
        if(username !="")
        {
            var httpRequest = new XMLHttpRequest();
            httpRequest.open('POST', '/XJTU/checkUser/', true);
            httpRequest.setRequestHeader("Content-type","application/x-www-form-urlencoded");
            httpRequest.onload = function(e) {
                if(this.status == 200||this.status == 304){
                    if (this.responseText == '1'){
                        document.getElementById("username_check").innerHTML = "<font color='red' size='3px'>该用户名已经注册过了哦</font>";
                    }
                    else {
                        document.getElementById("username_check").innerHTML = "<font color='green' size='3px'>√</font>";
                    }
                }
            }
            httpRequest.send('username='+username);

        }else{
            document.getElementById("username_check").innerHTML = "<font color='red' size='3px'>用户名不能为空！</font>";
        }

    }

 	//函数2：验证密码是否符合要求：匹配6位密码，由数字和字母组成：
  	function validate_password(password){
  		//^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6-10}$
		//测试密码：12345y
  		var passwordReg=/^[a-z0-9]{6,18}$/;
  		if(password != "" && password.search(passwordReg) != -1)
  		{
            document.getElementById("userPassword_check").innerHTML = "<font color='green' size='3px'>√</font>";

  		}else{
  			document.getElementById("userPassword_check").innerHTML = "<font color='red' size='3px'>密码格式错误</font>";
  		}
  	}

	//函数3：验证两次输入的密码是否一样
  	 function validate_password2(password2){
  		var password = document.getElementById("userPassword").value;
  		//测试：console.log(password);
  		//测试：console.log(password2);
  		if (password == ""){
			document.getElementById("userRePassword_check").innerHTML = "<font color='red' size='3px'>密码不为空</font>";
		}else if(password==password2){
  			document.getElementById("userRePassword_check").innerHTML = "<font color='green' size='3px'>√</font>";
  		}else{
  			document.getElementById("userRePassword_check").innerHTML = "<font color='red' size='3px'>两次输入的密码不相同</font>";
  			//console.log("密码有6位，由数字和字母组成!");
  		}
  	}

	//函数4：验证表单是否已经填好
  	function validate_form(){
  		var username = document.getElementById("username").value;
  		var password = document.getElementById("userPassword").value;
  		var password2 = document.getElementById("userRePassword").value;
  		//console.log("表单填写正确，可以正常提交！");

  		//这三个，如果任何一个有问题，都返回false
  		//18128@qq.com		12345y
  		var emailReg=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;
  		var passwordReg=/^[a-z0-9]{6,18}$/;

  		if(username != ""){
  			if(password !="" && passwordReg.test(password)){
  				if(password2==password){
  					alert("注册成功！点击跳转")
  					{#console.log("信息填写正确，可以正常提交！");#}
  					return true;
  				}else{
  					alert("密码不一致，提交失败，请重新填写！");
  					console.log("密码不一致，提交失败，请重新填写！");
  					return false;
  				}
  			}else{
  				alert("密码格式错误，提交失败，请重新填写！");
  				console.log("密码格式错误，提交失败，请重新填写！");
  				return false;
  			}
  		}else{
  			alert("注册的账号不符合要求，提交失败，请重新填写！");
  			console.log("注册的账号不符合要求，提交失败，请重新填写！");
  			return false;
  		}
  	}


  </script>


<body>
	<div class="xiao-container">
		<div class="xiao-register-box">
			<div class="xiao-title-box">
				<span>用户注册</span>
			</div>
			<form action="/XJTU/register/" method="post">
				<div class="xiao-username-box">
					<span class="xiao-require">*</span>
					<label for="username">用户名</label>
					<div class="xiao-username-input">
						<input type="text" id="username" name="username" placeholder="请输入用户名，如XJTUUP" onblur="validate_username(this.value)"/>
					</div>
                    <span class="xiao-require" id="username_check"></span>
				</div>


				<div class="xiao-userPassword-box">
					<span class="xiao-require">*</span>
					<label for="userPassword">密码</label>
					<div class="xiao-userPassword-input">
						<input type="password" id="userPassword" name="password" placeholder="密码由字母或数字组成 长度:6-18个字符" onblur="validate_password(this.value)"/>
					</div>
                    <span class="xiao-require" id="userPassword_check"></span>
				</div>

				<div class="xiao-userRePassword-box">
				    <span class="xiao-require">*</span>
                    <label for="userRePassword">确认密码</label>
					<div class="xiao-userRePassword-input">
						<input type="password" id="userRePassword" name="userRePassword" placeholder="请重复输入密码" onblur="validate_password2(this.value)"/>
					</div>
                    <span class="xiao-require" id="userRePassword_check"></span>
				</div>

				<div class="xiao-userPhone-box">
					<span class="xiao-require">&nbsp</span>
					<label for="userPhone">手机号码</label>
					<div class="xiao-userPhone-input">
						<input type="text" id="userPhone" name="userPhone" placeholder="请输入您的手机号码，11位有效数字" />
					</div>
                    <span class="xiao-require" id="userPhone_check"></span>
				</div>

				<div class="xiao-userEmail-box">
					<span class="xiao-require">&nbsp</span>
					<label for="userEmail">电子邮箱</label>
					<div class="xiao-userEmail-input">
						<input type="text" id="userEmail" name="userEmail" placeholder="请输入您的邮箱地址，如：123@qq.com" />
					</div>
                    <span class="xiao-require" id="userEmail_check"></span>
				</div>

                <div class="xiao-userMajor-box">
					<span class="xiao-require">&nbsp</span>
					<label for="userMajor">专业</label>
					<div class="xiao-userMajor-input">
						<input type="text" id="userMajor" name="userMajor" placeholder="请输入您的专业，如自动化" />
					</div>
                    <span class="xiao-require" id="userMajor_check"></span>
				</div>

                <div class="xiao-userGrade-box">
					<span class="xiao-userGrade">&nbsp</span>
					<label for="userGrade">年级</label>
					<div class="xiao-userGrade-input">
						<input type="text" id="userGrade" name="userGrade" placeholder="请输入您的年级，如2019级" />
					</div>
                    <span class="xiao-require" id="userGrade_check"></span>
				</div>

				<div class="xiao-userGender-box">
					<span class="xiao-require">*</span>
					<label for="userGender">性别</label>
					<div class="xiao-userGender-input">
						<input type="radio" id="userGender_01" name="userGender" value="0" checked="checked" />男
						<input type="radio" id="userGender_02" name="userGender" value="1" />女
                        <input type="radio" id="userGender_03" name="userGender" value="2" />保密
					</div>
				</div>

				<div class="xiao-submit-box">
					<input id = "xiao-submit-button" type="submit" value="注册" onclick="return validate_form()">
				</div>

				<div class="xiao-goLogin-box">
					<a href="/XJTU/login/" style="text-decoration: none;">已有账号？去登录</a>
				</div>
			</form>
		</div>
	</div>
</body>
</html>